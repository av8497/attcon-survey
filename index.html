<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fashion Behavior Study - v46</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
    </script>
</body>
</html>

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f5f5f7;
            min-height: 100vh;
            -webkit-overflow-scrolling: touch;
        }

        /* Consent Screen */
        .consent-screen {
            display: flex;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .consent-container {
            max-width: 800px;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            text-align: center;
        }

        .consent-container h1 {
            font-size: 28px;
            margin-bottom: 20px;
            color: #333;
        }

        .consent-text {
            font-size: 16px;
            line-height: 1.6;
            color: #666;
            margin-bottom: 30px;
            text-align: left;
        }

        .consent-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px 0;
            justify-content: center;
        }

        .continue-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .continue-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .continue-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        /* Demographics Form */
        .demographic-form {
            display: none;
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
            background: white;
            min-height: 100vh;
        }

        .demographic-form h2 {
            text-align: center;
            margin-bottom: 10px;
            color: #333;
        }

        .demographic-form p {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #333;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .checkbox-container {
            display: flex;
            align-items: flex-start;
            gap: 8px;
            margin-top: 8px;
            flex-wrap: wrap;
        }

        .checkbox-container input[type="checkbox"] {
            margin: 3px 0 0 0;
            flex-shrink: 0;
        }

        .checkbox-container label {
            font-size: 12px;
            color: #666;
            line-height: 1.3;
            flex: 1;
            min-width: 0;
            word-wrap: break-word;
        }

        .start-btn {
            width: 100%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .start-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        /* Interface Selection */
        .interface-selection {
            display: none;
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
            text-align: center;
            background: white;
            min-height: 100vh;
        }

        .selection-title {
            font-size: 24px;
            margin-bottom: 20px;
            color: #333;
        }

        .selection-subtitle {
            color: #666;
            margin-bottom: 40px;
            font-size: 16px;
        }

        .interface-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .interface-option {
            border: 3px solid #eee;
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
        }

        .interface-option:hover {
            border-color: #667eea;
            transform: translateY(-5px);
        }

        .interface-option.selected {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .interface-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .interface-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .interface-desc {
            font-size: 14px;
            color: #666;
        }

        /* Survey Container */
        .survey-container {
            display: none;
            min-height: 100vh;
            flex-direction: column;
        }

        .survey-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .progress-info {
            font-size: 14px;
        }

        .progress-bar {
            background: rgba(255,255,255,0.3);
            height: 4px;
            border-radius: 2px;
            margin-top: 10px;
            overflow: hidden;
        }

        .progress-fill {
            background: white;
            height: 100%;
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Enhanced mobile scrolling optimizations */
        .feed-container {
            flex: 1;
            padding: 10px;
            background: #f5f5f5;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            scroll-behavior: smooth;
        }

        /* Platform-specific post sizing for smooth scrolling */
        .facebook-feed .post {
            max-height: 400px;
            margin-bottom: 20px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }

        .instagram-feed .post {
            max-height: 450px;
            margin-bottom: 20px;
            background: white;
            border: 1px solid #dbdbdb;
            border-radius: 3px;
        }

        .linkedin-feed .post {
            max-height: 420px;
            margin-bottom: 20px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e1e9ee;
            box-shadow: 0 0 0 1px rgba(0,0,0,0.15), 0 2px 3px rgba(0,0,0,0.2);
        }

        .tiktok-feed .post {
            height: calc(100vh - 100px);
            margin-bottom: 0;
            scroll-snap-align: start;
        }

        .tiktok-feed {
            scroll-snap-type: y mandatory;
        }

        /* Optimized image placeholders */
        .post-image-placeholder {
            background: linear-gradient(45deg, #f0f0f0, #e0e0e0);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #666;
            font-size: 14px;
            font-weight: 500;
        }

        .facebook-feed .post-image-placeholder {
            height: 180px;
        }

        .instagram-feed .post-image-placeholder {
            height: 200px;
        }

        .linkedin-feed .post-image-placeholder {
            height: 170px;
        }

        .tiktok-feed .post-image-placeholder {
            height: 70vh;
        }

        /* Post Styles */
        .post {
            background: white;
            margin-bottom: 20px;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            max-height: 450px;
        }

        .post-header {
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            border-bottom: 1px solid #e1e5e9;
        }

        .post-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea, #764ba2);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .post-info {
            flex: 1;
        }

        .post-brand {
            font-weight: 600;
            color: #333;
        }

        .post-time {
            font-size: 12px;
            color: #666;
        }

        .post-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .post-content {
            padding: 15px;
        }

        .post-text {
            font-size: 14px;
            line-height: 1.4;
            margin-bottom: 15px;
            color: #333;
        }

        .post-price {
            font-size: 18px;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 15px;
        }

        .post-actions {
            display: flex;
            gap: 10px;
            justify-content: space-around;
            padding-top: 10px;
            border-top: 1px solid #e1e5e9;
        }

        .action-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .like-btn {
            background: #ff6b6b;
            color: white;
        }

        .share-btn {
            background: #4ecdc4;
            color: white;
        }

        .follow-btn {
            background: #667eea;
            color: white;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .action-btn:active {
            transform: translateY(0);
        }

        /* Results Screen */
        .results-screen {
            display: none;
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
            text-align: center;
            background: white;
            min-height: 100vh;
        }

        .results-title {
            font-size: 28px;
            margin-bottom: 20px;
            color: #333;
        }

        .results-summary {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .download-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .consent-container {
                padding: 30px 20px;
            }
            
            .demographic-form,
            .interface-selection {
                padding: 20px;
            }
            
            .interface-options {
                grid-template-columns: 1fr;
            }
            
            .post {
                margin-bottom: 15px;
            }
            
            .post-actions {
                flex-direction: column;
                gap: 8px;
            }
        }
    </style>
</head>
<body>
    <!-- Consent Screen -->
    <div class="consent-screen" id="consentScreen">
        <div class="consent-container">
            <h1>Fashion Behavior Study</h1>
            <div class="consent-text">
                <p><strong>Research Purpose:</strong> This study examines how different social media platforms influence fashion discovery and purchasing decisions across age groups.</p>
                
                <p><strong>What You'll Do:</strong> You'll interact with fashion posts in different social media interface styles and answer questions about your preferences and behaviors.</p>
                
                <p><strong>Time Required:</strong> Approximately 5-10 minutes</p>
                
                <p><strong>Data Use:</strong> Your responses will be used for academic research purposes only. All data will be anonymized and kept confidential.</p>
                
                <p><strong>Voluntary Participation:</strong> Your participation is completely voluntary and you may withdraw at any time.</p>
            </div>
            
            <div class="consent-checkbox">
                <input type="checkbox" id="consentCheckbox">
                <label for="consentCheckbox">
                    I understand the study purpose and agree to participate. I consent to my anonymous responses being used for research purposes.
                </label>
            </div>
            
            <button class="continue-btn" id="continueBtn" onclick="showDemographics()" disabled>
                Begin Research Study
            </button>
        </div>
    </div>

    <!-- Demographics Section -->
    <div class="demographic-form" id="demographicForm">
        <h2>Tell us about yourself</h2>
        <p>This helps us understand shopping behavior across different demographics and regions</p>
        
        <div class="form-group">
            <label>Your Name</label>
            <input type="text" id="participantName" placeholder="Enter your first name" required>
            <div class="checkbox-container">
                <input type="checkbox" id="anonymousCheckbox">
                <label for="anonymousCheckbox">
                    I want to be anonymous (assigns a random ID instead of your name)
                </label>
            </div>
        </div>

        <div class="form-group">
            <label>Age Range</label>
            <select id="ageRange" required>
                <option value="">Select your age range</option>
                <option value="18-24">18-24 years</option>
                <option value="25-29">25-29 years</option>
                <option value="30-34">30-34 years</option>
                <option value="35-39">35-39 years</option>
                <option value="40-44">40-44 years</option>
                <option value="45-50">45-50 years</option>
                <option value="50+">50+ years</option>
            </select>
        </div>

        <div class="form-group">
            <label>Country</label>
            <select id="country" onchange="updateCurrencyAndIncome()" required>
                <option value="">Select your country</option>
                <option value="AE">United Arab Emirates</option>
                <option value="SA">Saudi Arabia</option>
                <option value="IN">India</option>
                <option value="PK">Pakistan</option>
                <option value="US">United States</option>
                <option value="UK">United Kingdom</option>
                <option value="CA">Canada</option>
                <option value="AU">Australia</option>
                <option value="DE">Germany</option>
                <option value="FR">France</option>
                <option value="Other">Other</option>
            </select>
        </div>

        <div class="form-group">
            <label>Monthly Income <span id="currencyLabel">(USD)</span></label>
            <select id="monthlyIncome" required>
                <option value="">Select income range</option>
                <!-- Options will be populated based on country selection -->
            </select>
        </div>

        <div class="form-group">
            <label>Gender</label>
            <select id="gender" required>
                <option value="">Select gender</option>
                <option value="Female">Female</option>
                <option value="Male">Male</option>
                <option value="Non-binary">Non-binary</option>
                <option value="Prefer not to say">Prefer not to say</option>
            </select>
        </div>

        <div class="form-group">
            <label>Primary Social Media Platform for Fashion Discovery</label>
            <select id="primaryPlatform" required>
                <option value="">Select primary platform</option>
                <option value="Instagram">Instagram</option>
                <option value="TikTok">TikTok</option>
                <option value="Facebook">Facebook</option>
                <option value="LinkedIn">LinkedIn</option>
                <option value="Twitter">Twitter</option>
                <option value="Pinterest">Pinterest</option>
                <option value="YouTube">YouTube</option>
                <option value="Snapchat">Snapchat</option>
                <option value="Other">Other</option>
            </select>
        </div>

        <div class="form-group">
            <label>How often do you shop for fashion items?</label>
            <select id="shoppingFrequency" required>
                <option value="">Select frequency</option>
                <option value="Daily">Daily</option>
                <option value="Weekly">Weekly</option>
                <option value="Monthly">Monthly</option>
                <option value="Every few months">Every few months</option>
                <option value="Rarely">Rarely</option>
                <option value="Never">Never</option>
            </select>
        </div>

        <button class="start-btn" id="startBtn" onclick="showInterfaceSelection()" disabled>
            Continue to Platform Selection
        </button>
    </div>

    <!-- Interface Selection -->
    <div class="interface-selection" id="interfaceSelection">
        <h2 class="selection-title">Choose Your Experience</h2>
        <p class="selection-subtitle">Select which social media interface style you'd like to experience:</p>
        
        <div class="interface-options">
            <div class="interface-option" data-interface="facebook" onclick="selectInterface('facebook')">
                <div class="interface-icon">📘</div>
                <div class="interface-name">Facebook Style</div>
                <div class="interface-desc">Detailed posts with rich information</div>
            </div>
            
            <div class="interface-option" data-interface="instagram" onclick="selectInterface('instagram')">
                <div class="interface-icon">📷</div>
                <div class="interface-name">Instagram Style</div>
                <div class="interface-desc">Visual-first, clean layout</div>
            </div>
            
            <div class="interface-option" data-interface="linkedin" onclick="selectInterface('linkedin')">
                <div class="interface-icon">💼</div>
                <div class="interface-name">LinkedIn Style</div>
                <div class="interface-desc">Professional, business-focused</div>
            </div>
            
            <div class="interface-option" data-interface="tiktok" onclick="selectInterface('tiktok')">
                <div class="interface-icon">🎵</div>
                <div class="interface-name">TikTok Style</div>
                <div class="interface-desc">Full-screen, immersive experience</div>
            </div>
        </div>
        
        <button class="start-btn" id="startSurveyBtn" onclick="startSurvey()" disabled>
            Start Experience
        </button>
    </div>

    <!-- Survey Container -->
    <div class="survey-container" id="surveyContainer">
        <div class="survey-header">
            <div class="progress-info">
                <div>Question <span id="currentQuestion">1</span> of <span id="totalQuestions">15</span></div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>
            <div id="timeDisplay">Time: 0:00</div>
        </div>
        
        <div class="feed-container" id="feedContainer">
            <!-- Posts will be dynamically inserted here -->
        </div>
    </div>

    <!-- Results Screen -->
    <div class="results-screen" id="resultsScreen">
        <h2 class="results-title">Thank you for participating!</h2>
        <div class="results-summary" id="resultsSummary">
            <!-- Results will be displayed here -->
        </div>
        <button class="download-btn" onclick="downloadResults()">
            Download Your Results
        </button>
    </div>

    <script>
        // Global variables
        let currentQuestionIndex = 0;
        let selectedInterface = '';
        let answers = [];
        let startTime = Date.now();
        let questionStartTime = Date.now();
        let demographics = {};
        
        // Sample questions for the survey
        const surveyQuestions = [
            {
                facebook: {
                    brand: "TRENDSETTER",
                    username: "trendsetter_official",
                    timeAgo: "2h",
                    text: "When you discover new brands on social media, which platforms make you feel most confident about their quality and authenticity? Consider the information available, user reviews, and how brands present themselves.",
                    image: "Sustainable Cotton T-Shirt",
                    price: "$45",
                    options: { 
                        like: "Visual platforms (Instagram/TikTok)", 
                        share: "Information-rich platforms (Facebook/LinkedIn)", 
                        follow: "Depends on the brand type" 
                    }
                },
                instagram: {
                    brand: "TRENDSETTER",
                    username: "@trendsetter",
                    timeAgo: "2h",
                    text: "Which platform makes you trust brands more? 🤔",
                    image: "Cotton Tee",
                    price: "$45",
                    options: { 
                        like: "Visual platforms", 
                        share: "Info-rich platforms", 
                        follow: "Depends on brand" 
                    }
                },
                linkedin: {
                    brand: "Professional Attire Co.",
                    username: "professional_attire",
                    timeAgo: "3h",
                    text: "Platform trust varies by consumer demographics and brand positioning. Which platforms do you find most credible for brand discovery?",
                    image: "Business Casual Shirt",
                    price: "$45",
                    options: { 
                        like: "Visual-first platforms", 
                        share: "Text-heavy platforms", 
                        follow: "Context-dependent" 
                    }
                },
                tiktok: {
                    brand: "TRENDSETTER",
                    username: "@trendsetter",
                    timeAgo: "2h",
                    text: "Which app makes you trust brands more? 👀",
                    image: "Trendy Tee",
                    price: "$45",
                    options: { 
                        like: "TikTok/Instagram", 
                        share: "Facebook/LinkedIn", 
                        follow: "It depends" 
                    }
                }
            },
            {
                facebook: {
                    brand: "MINDFUL SHOPPING",
                    username: "mindful_shopping",
                    timeAgo: "4h",
                    text: "Think about your last purchase discovered through social media. How many times did you see the product before buying? Did you research it elsewhere? What finally convinced you to purchase?",
                    image: "Eco-Friendly Sneakers",
                    price: "$89",
                    options: { 
                        like: "Saw it multiple times everywhere", 
                        share: "Friend recommendation was key", 
                        follow: "Price/sale made it affordable" 
                    }
                },
                instagram: {
                    brand: "MINDFUL",
                    username: "@mindful_shop",
                    timeAgo: "4h",
                    text: "Your last social media purchase - what made you buy? 🛍️",
                    image: "Eco Sneakers",
                    price: "$89",
                    options: { 
                        like: "Saw everywhere", 
                        share: "Friend recommended", 
                        follow: "Price was right" 
                    }
                },
                linkedin: {
                    brand: "Sustainable Footwear Ltd.",
                    username: "sustainable_footwear",
                    timeAgo: "5h",
                    text: "Consumer purchase journeys increasingly span multiple touchpoints. What drives your final purchase decision after social media discovery?",
                    image: "Professional Sneakers",
                    price: "$89",
                    options: { 
                        like: "Repeated exposure", 
                        share: "Social validation", 
                        follow: "Value proposition" 
                    }
                },
                tiktok: {
                    brand: "MINDFUL",
                    username: "@mindful",
                    timeAgo: "4h",
                    text: "What made you actually buy that thing you saw on social? 💳",
                    image: "Cool Sneakers",
                    price: "$89",
                    options: { 
                        like: "Kept seeing it", 
                        share: "Friends had it", 
                        follow: "Good deal" 
                    }
                }
            },
            {
                facebook: {
                    brand: "REALITY CHECK",
                    username: "reality_check_fashion",
                    timeAgo: "6h",
                    text: "We've all loved posts but never bought the items. What's the biggest gap between what catches your attention online and what you actually purchase? Price, practicality, or something else?",
                    image: "Designer-Inspired Handbag",
                    price: "$156",
                    options: { 
                        like: "Too expensive for my budget", 
                        share: "Doesn't match real lifestyle", 
                        follow: "Just browsing, not shopping" 
                    }
                },
                instagram: {
                    brand: "REALITY",
                    username: "@realitycheck",
                    timeAgo: "6h",
                    text: "Why do you love posts but not buy the items? 🤷‍♀️",
                    image: "Cute Handbag",
                    price: "$156",
                    options: { 
                        like: "Too pricey", 
                        share: "Not practical", 
                        follow: "Just browsing" 
                    }
                },
                linkedin: {
                    brand: "Consumer Behavior Analytics",
                    username: "consumer_insights",
                    timeAgo: "7h",
                    text: "The engagement-conversion gap remains a significant challenge. What factors prevent social media engagement from translating to purchases?",
                    image: "Professional Handbag",
                    price: "$156",
                    options: { 
                        like: "Budget constraints", 
                        share: "Practicality concerns", 
                        follow: "Research mode vs buy mode" 
                    }
                },
                tiktok: {
                    brand: "REALITY",
                    username: "@realitycheck",
                    timeAgo: "6h",
                    text: "Why love but not buy? 🛒❌",
                    image: "Fire Handbag",
                    price: "$156",
                    options: { 
                        like: "Broke lol", 
                        share: "Not my vibe", 
                        follow: "Window shopping" 
                    }
                }
            }
        ];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            // Consent checkbox functionality
            document.getElementById('consentCheckbox').addEventListener('change', function() {
                document.getElementById('continueBtn').disabled = !this.checked;
            });

            // Form validation
            setupFormValidation();
        });

        function setupFormValidation() {
            const formFields = ['participantName', 'ageRange', 'country', 'monthlyIncome', 'gender', 'primaryPlatform', 'shoppingFrequency'];
            const startBtn = document.getElementById('startBtn');

            function validateForm() {
                const allFilled = formFields.every(fieldId => {
                    const field = document.getElementById(fieldId);
                    return field.value.trim() !== '';
                });
                startBtn.disabled = !allFilled;
            }

            formFields.forEach(fieldId => {
                document.getElementById(fieldId).addEventListener('change', validateForm);
                document.getElementById(fieldId).addEventListener('input', validateForm);
            });

            // Anonymous checkbox functionality
            document.getElementById('anonymousCheckbox').addEventListener('change', function() {
                const nameField = document.getElementById('participantName');
                if (this.checked) {
                    nameField.value = generateAnonymousId();
                    nameField.readOnly = true;
                } else {
                    nameField.value = '';
                    nameField.readOnly = false;
                }
                validateForm();
            });
        }

        function generateAnonymousId() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let result = 'ANON';
            for (let i = 0; i < 8; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return result;
        }

        function updateCurrencyAndIncome() {
            const country = document.getElementById('country').value;
            const currencyLabel = document.getElementById('currencyLabel');
            const incomeSelect = document.getElementById('monthlyIncome');
            
            // Clear existing options
            incomeSelect.innerHTML = '<option value="">Select income range</option>';
            
            let currency = 'USD';
            let incomeRanges = [];
            
            switch(country) {
                case 'AE':
                    currency = 'AED';
                    incomeRanges = [
                        'Under 3,000 AED',
                        '3,000 - 5,000 AED', 
                        '5,000 - 8,000 AED',
                        '8,000 - 12,000 AED',
                        '12,000 - 18,000 AED',
                        '18,000 - 25,000 AED',
                        'Over 25,000 AED'
                    ];
                    break;
                case 'SA':
                    currency = 'SAR';
                    incomeRanges = [
                        'Under 3,000 SAR',
                        '3,000 - 5,000 SAR',
                        '5,000 - 8,000 SAR', 
                        '8,000 - 12,000 SAR',
                        '12,000 - 18,000 SAR',
                        '18,000 - 25,000 SAR',
                        'Over 25,000 SAR'
                    ];
                    break;
                case 'IN':
                    currency = 'INR';
                    incomeRanges = [
                        'Under 25,000 INR',
                        '25,000 - 50,000 INR',
                        '50,000 - 75,000 INR',
                        '75,000 - 100,000 INR', 
                        '100,000 - 150,000 INR',
                        '150,000 - 200,000 INR',
                        'Over 200,000 INR'
                    ];
                    break;
                case 'PK':
                    currency = 'PKR';
                    incomeRanges = [
                        'Under 50,000 PKR',
                        '50,000 - 75,000 PKR',
                        '75,000 - 100,000 PKR',
                        '100,000 - 150,000 PKR',
                        '150,000 - 200,000 PKR', 
                        '200,000 - 300,000 PKR',
                        'Over 300,000 PKR'
                    ];
                    break;
                case 'UK':
                    currency = 'GBP';
                    incomeRanges = [
                        'Under £2,000',
                        '£2,000 - £3,000',
                        '£3,000 - £4,000',
                        '£4,000 - £5,000',
                        '£5,000 - £7,000',
                        '£7,000 - £10,000',
                        'Over £10,000'
                    ];
                    break;
                case 'CA':
                    currency = 'CAD';
                    incomeRanges = [
                        'Under $2,500 CAD',
                        '$2,500 - $4,000 CAD',
                        '$4,000 - $5,500 CAD',
                        '$5,500 - $7,000 CAD',
                        '$7,000 - $9,000 CAD',
                        '$9,000 - $12,000 CAD',
                        'Over $12,000 CAD'
                    ];
                    break;
                case 'AU':
                    currency = 'AUD';
                    incomeRanges = [
                        'Under $2,500 AUD',
                        '$2,500 - $4,000 AUD',
                        '$4,000 - $5,500 AUD',
                        '$5,500 - $7,000 AUD',
                        '$7,000 - $9,000 AUD',
                        '$9,000 - $12,000 AUD',
                        'Over $12,000 AUD'
                    ];
                    break;
                case 'DE':
                    currency = 'EUR';
                    incomeRanges = [
                        'Under €2,000',
                        '€2,000 - €3,000',
                        '€3,000 - €4,000',
                        '€4,000 - €5,000',
                        '€5,000 - €7,000',
                        '€7,000 - €10,000',
                        'Over €10,000'
                    ];
                    break;
                case 'FR':
                    currency = 'EUR';
                    incomeRanges = [
                        'Under €2,000',
                        '€2,000 - €3,000',
                        '€3,000 - €4,000',
                        '€4,000 - €5,000',
                        '€5,000 - €7,000',
                        '€7,000 - €10,000',
                        'Over €10,000'
                    ];
                    break;
                default:
                    currency = 'USD';
                    incomeRanges = [
                        'Under $2,000',
                        '$2,000 - $3,500',
                        '$3,500 - $5,000',
                        '$5,000 - $7,000',
                        '$7,000 - $10,000',
                        '$10,000 - $15,000',
                        'Over $15,000'
                    ];
            }
            
            currencyLabel.textContent = `(${currency})`;
            
            incomeRanges.forEach(range => {
                const option = document.createElement('option');
                option.value = range;
                option.textContent = range;
                incomeSelect.appendChild(option);
            });
        }

        function showDemographics() {
            document.getElementById('consentScreen').style.display = 'none';
            document.getElementById('demographicForm').style.display = 'block';
        }

        function showInterfaceSelection() {
            // Store demographics
            demographics = {
                name: document.getElementById('participantName').value,
                age: document.getElementById('ageRange').value,
                country: document.getElementById('country').value,
                income: document.getElementById('monthlyIncome').value,
                gender: document.getElementById('gender').value,
                primaryPlatform: document.getElementById('primaryPlatform').value,
                shoppingFrequency: document.getElementById('shoppingFrequency').value,
                anonymous: document.getElementById('anonymousCheckbox').checked
            };
            
            document.getElementById('demographicForm').style.display = 'none';
            document.getElementById('interfaceSelection').style.display = 'block';
        }

        function selectInterface(interface) {
            document.querySelectorAll('.interface-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            document.querySelector(`[data-interface="${interface}"]`).classList.add('selected');
            selectedInterface = interface;
            document.getElementById('startSurveyBtn').disabled = false;
        }

        function startSurvey() {
            document.getElementById('interfaceSelection').style.display = 'none';
            document.getElementById('surveyContainer').style.display = 'flex';
            
            // Initialize survey
            initializeSurvey();
        }

        function initializeSurvey() {
            const feedContainer = document.getElementById('feedContainer');
            feedContainer.innerHTML = ''; // Clear any existing content
            feedContainer.className = `feed-container ${selectedInterface}-feed`;
            
            // Update total questions
            document.getElementById('totalQuestions').textContent = surveyQuestions.length;
            
            // Generate all posts at once for smooth scrolling
            surveyQuestions.forEach((question, index) => {
                const post = createPost(question, index);
                feedContainer.appendChild(post);
            });
            
            // Apply smooth scrolling behavior for all interfaces except TikTok
            if (selectedInterface !== 'tiktok') {
                feedContainer.style.height = 'calc(100vh - 100px)';
                feedContainer.style.overflowY = 'auto';
                feedContainer.style.scrollBehavior = 'smooth';
                feedContainer.style.webkitOverflowScrolling = 'touch';
            }
            
            // Start timer
            startTimer();
            
            // Show first post
            updateProgress();
        }

        function createPost(question, index) {
            const post = document.createElement('div');
            post.className = 'post';
            post.setAttribute('data-question', index);
            
            const questionData = question[selectedInterface];
            const isAnswered = answers[index] !== undefined;
            
            // Get currency symbol based on user's country
            const currencySymbol = getCurrencySymbol();
            const convertedPrice = convertPrice(questionData.price, currencySymbol);
            
            if (selectedInterface === 'facebook') {
                post.innerHTML = createFacebookPost(questionData, index, isAnswered, convertedPrice);
            } else if (selectedInterface === 'instagram') {
                post.innerHTML = createInstagramPost(questionData, index, isAnswered, convertedPrice);
            } else if (selectedInterface === 'linkedin') {
                post.innerHTML = createLinkedInPost(questionData, index, isAnswered, convertedPrice);
            } else if (selectedInterface === 'tiktok') {
                post.innerHTML = createTikTokPost(questionData, index, isAnswered, convertedPrice);
            }
            
            return post;
        }

        function getCurrencySymbol() {
            const country = demographics.country;
            const currencyMap = {
                'AE': 'AED',
                'SA': 'SAR', 
                'IN': '₹',
                'PK': 'PKR',
                'US': '
            ,
                'UK': '£',
                'CA': 'CAD 
            ,
                'AU': 'AUD 
            ,
                'DE': '€',
                'FR': '€'
            };
            return currencyMap[country] || '
            ;
        }

        function convertPrice(originalPrice, targetCurrency) {
            // Extract numeric value from original price (assuming USD)
            const usdAmount = parseFloat(originalPrice.replace(/[^0-9.]/g, ''));
            
            // Conversion rates (approximate)
            const rates = {
                'AED': 3.67,
                'SAR': 3.75,
                '₹': 83,
                'PKR': 280,
                '
            : 1,
                '£': 0.79,
                'CAD 
            : 1.35,
                'AUD 
            : 1.50,
                '€': 0.92
            };
            
            const rate = rates[targetCurrency] || 1;
            const convertedAmount = Math.round(usdAmount * rate);
            
            if (targetCurrency === '₹') {
                return `₹${convertedAmount}`;
            } else if (targetCurrency === '£') {
                return `£${convertedAmount}`;
            } else if (targetCurrency === '€') {
                return `€${convertedAmount}`;
            } else if (targetCurrency.includes('AED')) {
                return `${convertedAmount} AED`;
            } else if (targetCurrency.includes('SAR')) {
                return `${convertedAmount} SAR`;
            } else if (targetCurrency.includes('PKR')) {
                return `${convertedAmount} PKR`;
            } else if (targetCurrency.includes('CAD')) {
                return `CAD ${convertedAmount}`;
            } else if (targetCurrency.includes('AUD')) {
                return `AUD ${convertedAmount}`;
            } else {
                return `${convertedAmount}`;
            }
        }

        function createFacebookPost(data, index, isAnswered, price) {
            return `
                <div class="post-header">
                    <div class="post-avatar">${data.brand[0]}</div>
                    <div class="post-info">
                        <div class="post-brand">${data.brand}</div>
                        <div class="post-time">${data.timeAgo}</div>
                    </div>
                </div>
                <div class="post-image-placeholder" style="background: linear-gradient(45deg, #f0f0f0, #e0e0e0); height: 200px; display: flex; align-items: center; justify-content: center; color: #666; font-size: 14px;">
                    ${data.image}
                </div>
                <div class="post-content">
                    <div class="post-text">${data.text}</div>
                    <div class="post-price">${price}</div>
                    <div class="post-actions">
                        <button class="action-btn like-btn" onclick="answerQuestion(${index}, 'like')" ${isAnswered ? 'disabled' : ''}>
                            👍 ${data.options.like}
                        </button>
                        <button class="action-btn share-btn" onclick="answerQuestion(${index}, 'share')" ${isAnswered ? 'disabled' : ''}>
                            📤 ${data.options.share}
                        </button>
                        <button class="action-btn follow-btn" onclick="answerQuestion(${index}, 'follow')" ${isAnswered ? 'disabled' : ''}>
                            ➕ ${data.options.follow}
                        </button>
                    </div>
                </div>
            `;
        }

        function createInstagramPost(data, index, isAnswered, price) {
            return `
                <div class="post-header">
                    <div class="post-avatar">${data.brand[0]}</div>
                    <div class="post-info">
                        <div class="post-brand">${data.username}</div>
                        <div class="post-time">${data.timeAgo}</div>
                    </div>
                </div>
                <div class="post-image-placeholder" style="background: linear-gradient(45deg, #f0f0f0, #e0e0e0); height: 200px; display: flex; align-items: center; justify-content: center; color: #666; font-size: 14px;">
                    ${data.image}
                </div>
                <div class="post-content">
                    <div class="post-text">${data.text}</div>
                    <div class="post-price">${price}</div>
                    <div class="post-actions">
                        <button class="action-btn like-btn" onclick="answerQuestion(${index}, 'like')" ${isAnswered ? 'disabled' : ''}>
                            ❤️ ${data.options.like}
                        </button>
                        <button class="action-btn share-btn" onclick="answerQuestion(${index}, 'share')" ${isAnswered ? 'disabled' : ''}>
                            📩 ${data.options.share}
                        </button>
                        <button class="action-btn follow-btn" onclick="answerQuestion(${index}, 'follow')" ${isAnswered ? 'disabled' : ''}>
                            👤 ${data.options.follow}
                        </button>
                    </div>
                </div>
            `;
        }

        function createLinkedInPost(data, index, isAnswered, price) {
            return `
                <div class="post-header">
                    <div class="post-avatar">${data.brand[0]}</div>
                    <div class="post-info">
                        <div class="post-brand">${data.brand}</div>
                        <div class="post-time">${data.timeAgo}</div>
                    </div>
                </div>
                <div class="post-image-placeholder" style="background: linear-gradient(45deg, #f0f0f0, #e0e0e0); height: 200px; display: flex; align-items: center; justify-content: center; color: #666; font-size: 14px;">
                    ${data.image}
                </div>
                <div class="post-content">
                    <div class="post-text">${data.text}</div>
                    <div class="post-price">${price}</div>
                    <div class="post-actions">
                        <button class="action-btn like-btn" onclick="answerQuestion(${index}, 'like')" ${isAnswered ? 'disabled' : ''}>
                            👍 ${data.options.like}
                        </button>
                        <button class="action-btn share-btn" onclick="answerQuestion(${index}, 'share')" ${isAnswered ? 'disabled' : ''}>
                            🔄 ${data.options.share}
                        </button>
                        <button class="action-btn follow-btn" onclick="answerQuestion(${index}, 'follow')" ${isAnswered ? 'disabled' : ''}>
                            🔗 ${data.options.follow}
                        </button>
                    </div>
                </div>
            `;
        }

        function createTikTokPost(data, index, isAnswered, price) {
            return `
                <div style="height: calc(100vh - 100px); display: flex; flex-direction: column;">
                    <div class="post-image-placeholder" style="background: linear-gradient(45deg, #f0f0f0, #e0e0e0); flex: 1; display: flex; align-items: center; justify-content: center; color: #666; font-size: 16px;">
                        ${data.image}
                    </div>
                    <div class="post-content" style="background: rgba(0,0,0,0.7); color: white; padding: 20px;">
                        <div class="post-brand" style="font-weight: bold; margin-bottom: 5px;">${data.username}</div>
                        <div class="post-text" style="margin-bottom: 10px;">${data.text}</div>
                        <div class="post-price" style="font-size: 18px; font-weight: bold; margin-bottom: 15px;">${price}</div>
                        <div class="post-actions">
                            <button class="action-btn like-btn" onclick="answerQuestion(${index}, 'like')" ${isAnswered ? 'disabled' : ''}>
                                ❤️ ${data.options.like}
                            </button>
                            <button class="action-btn share-btn" onclick="answerQuestion(${index}, 'share')" ${isAnswered ? 'disabled' : ''}>
                                📤 ${data.options.share}
                            </button>
                            <button class="action-btn follow-btn" onclick="answerQuestion(${index}, 'follow')" ${isAnswered ? 'disabled' : ''}>
                                ➕ ${data.options.follow}
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function answerQuestion(questionIndex, answer) {
            const responseTime = Date.now() - questionStartTime;
            
            answers[questionIndex] = {
                answer: answer,
                responseTime: responseTime,
                timestamp: Date.now()
            };
            
            // Disable all buttons for this question
            const post = document.querySelector(`[data-question="${questionIndex}"]`);
            const buttons = post.querySelectorAll('.action-btn');
            buttons.forEach(btn => btn.disabled = true);
            
            // Highlight selected answer
            const selectedBtn = post.querySelector(`.${answer}-btn`);
            selectedBtn.style.opacity = '1';
            selectedBtn.style.transform = 'scale(1.05)';
            
            currentQuestionIndex = Math.max(currentQuestionIndex, questionIndex + 1);
            
            // Auto-scroll to next question for non-TikTok interfaces
            if (selectedInterface !== 'tiktok' && questionIndex < surveyQuestions.length - 1) {
                setTimeout(() => {
                    const nextPost = document.querySelector(`[data-question="${questionIndex + 1}"]`);
                    if (nextPost) {
                        nextPost.scrollIntoView({ 
                            behavior: 'smooth', 
                            block: 'start',
                            inline: 'nearest'
                        });
                    }
                }, 500);
            }
            
            // Update progress
            updateProgress();
            
            // Check if survey is complete
            if (answers.filter(a => a !== undefined).length === surveyQuestions.length) {
                setTimeout(() => {
                    showResults();
                }, 1000);
            }
            
            questionStartTime = Date.now();
        }

        function updateProgress() {
            const answeredCount = answers.filter(a => a !== undefined).length;
            const progress = (answeredCount / surveyQuestions.length) * 100;
            
            document.getElementById('currentQuestion').textContent = answeredCount + 1;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function startTimer() {
            setInterval(() => {
                const elapsed = Math.floor((Date.now() - startTime) / 1000);
                const minutes = Math.floor(elapsed / 60);
                const seconds = elapsed % 60;
                document.getElementById('timeDisplay').textContent = 
                    `Time: ${minutes}:${seconds.toString().padStart(2, '0')}`;
            }, 1000);
        }

        function showResults() {
            document.getElementById('surveyContainer').style.display = 'none';
            document.getElementById('resultsScreen').style.display = 'block';
            
            const totalTime = Math.floor((Date.now() - startTime) / 1000);
            const avgResponseTime = answers.reduce((sum, a) => sum + a.responseTime, 0) / answers.length;
            
            const summary = `
                <h3>Your Survey Results</h3>
                <p><strong>Platform:</strong> ${selectedInterface.charAt(0).toUpperCase() + selectedInterface.slice(1)}</p>
                <p><strong>Total Questions:</strong> ${surveyQuestions.length}</p>
                <p><strong>Total Time:</strong> ${Math.floor(totalTime / 60)}:${(totalTime % 60).toString().padStart(2, '0')}</p>
                <p><strong>Average Response Time:</strong> ${(avgResponseTime / 1000).toFixed(1)} seconds</p>
                <p><strong>Thank you for contributing to fashion retail research!</strong></p>
            `;
            
            document.getElementById('resultsSummary').innerHTML = summary;
        }

        function downloadResults() {
            const results = {
                demographics: demographics,
                interface: selectedInterface,
                answers: answers,
                totalTime: Date.now() - startTime,
                timestamp: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(results, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = `fashion-survey-${demographics.age}-${demographics.gender}-${selectedInterface}-${Date.now()}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }
